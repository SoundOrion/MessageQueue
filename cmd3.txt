ã„ã„è³ªå•ã§ã™ï¼ğŸ’ª
Windowsã‚µãƒ¼ãƒ“ã‚¹ã‚’ã€Œ**ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆcmdï¼‰ã ã‘**ã§ç™»éŒ²ã€ã™ã‚‹ã«ã¯ã€
æ¨™æº–ã® **`sc.exe`** ã¾ãŸã¯ **`powershell New-Service`** ã‚’ä½¿ã„ã¾ã™ã€‚

---

## âœ… â‘  CMDï¼ˆscã‚³ãƒãƒ³ãƒ‰ï¼‰ã§ã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²ã™ã‚‹æ–¹æ³•

åŸºæœ¬æ§‹æ–‡ï¼š

```cmd
sc create <ã‚µãƒ¼ãƒ“ã‚¹å> binPath= "<exeã®ãƒ•ãƒ«ãƒ‘ã‚¹>" start= auto
```

### ä¾‹ï¼š

```cmd
cmd /c "sc create MyService binPath= \"C:\Program Files\MyApp\MyApp.exe\" start= auto"
```

ğŸ“˜ ã‚ªãƒ—ã‚·ãƒ§ãƒ³è§£èª¬ï¼š

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³       | èª¬æ˜                                    |
| ----------- | ------------------------------------- |
| `create`    | æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç™»éŒ²                            |
| `MyService` | ã‚µãƒ¼ãƒ“ã‚¹åï¼ˆä»»æ„ã®åå‰ï¼‰                          |
| `binPath=`  | å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ãƒ«ãƒ‘ã‚¹ï¼ˆ`=` ã®å¾Œã«**ã‚¹ãƒšãƒ¼ã‚¹å¿…é ˆï¼**ï¼‰       |
| `start=`    | èµ·å‹•ã‚¿ã‚¤ãƒ—ï¼ˆ`auto` / `demand` / `disabled`ï¼‰ |

ğŸ’¡æ³¨æ„ï¼š
`binPath=` ã®ç›´å¾Œã«**å¿…ãšã‚¹ãƒšãƒ¼ã‚¹ãŒå¿…è¦**ã§ã™ã€‚
ã“ã‚Œã‚’å¿˜ã‚Œã‚‹ã¨ã€Œã‚¨ãƒ©ãƒ¼ 87: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€ã¨å‡ºã¾ã™ã€‚

---

### ã‚µãƒ¼ãƒ“ã‚¹ã®èª¬æ˜ãƒ»è¡¨ç¤ºåã‚’è¿½åŠ ã™ã‚‹å ´åˆ

```cmd
cmd /c "sc create MyService binPath= \"C:\Program Files\MyApp\MyApp.exe\" start= auto DisplayName= \"My Custom Service\""
```

---

### ç™»éŒ²å¾Œã«èª¬æ˜æ–‡ã‚’è¨­å®š

```cmd
cmd /c "sc description MyService \"My background worker service\""
```

---

### ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•

```cmd
cmd /c "net start MyService"
```

### ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢

```cmd
cmd /c "net stop MyService"
```

### ã‚µãƒ¼ãƒ“ã‚¹å‰Šé™¤

```cmd
cmd /c "sc delete MyService"
```

---

## âœ… â‘¡ PowerShell ã§ç™»éŒ²ã™ã‚‹å ´åˆï¼ˆcmd /c çµŒç”±OKï¼‰

```cmd
cmd /c "powershell -NoProfile -Command \"New-Service -Name 'MyService' -BinaryPathName 'C:\Program Files\MyApp\MyApp.exe' -DisplayName 'My Custom Service' -StartupType Automatic\""
```

ğŸ“˜

* `-StartupType Automatic` â†’ è‡ªå‹•èµ·å‹•
* `New-Service` ã¯ PowerShell æ¨™æº–ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ã™

---

## âœ… â‘¢ C# ã® `ProcessStartInfo` ã‹ã‚‰ç™»éŒ²ã™ã‚‹å ´åˆ

```csharp
var psi = new ProcessStartInfo
{
    FileName = Environment.GetEnvironmentVariable("ComSpec"),
    Arguments = "/c sc create MyService binPath= \"C:\\Program Files\\MyApp\\MyApp.exe\" start= auto",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    RedirectStandardError = true,
    CreateNoWindow = true
};
```

---

## âœ… â‘£ æ—¢å­˜ã‚µãƒ¼ãƒ“ã‚¹ã®çŠ¶æ…‹ç¢ºèª

```cmd
cmd /c "sc query MyService"
```

---

## âœ… â‘¤ ç™»éŒ²å¾Œã«ãƒˆãƒ©ãƒ–ãƒ«ãŒã‚ã‚‹å ´åˆ

* å®Ÿè¡Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã€Œãƒ­ãƒ¼ã‚«ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã€ã«ãªã‚Šã¾ã™
  â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§å‹•ã‹ã—ãŸã„å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ï¼š

```cmd
sc config MyService obj= ".\MyUser" password= "MyPassword"
```

---

## ğŸ”§ ã¾ã¨ã‚

| æ“ä½œ   | ã‚³ãƒãƒ³ãƒ‰                                                          |
| ---- | ------------------------------------------------------------- |
| ç™»éŒ²   | `sc create MyService binPath= "C:\App\MyApp.exe" start= auto` |
| èµ·å‹•   | `net start MyService`                                         |
| åœæ­¢   | `net stop MyService`                                          |
| å‰Šé™¤   | `sc delete MyService`                                         |
| çŠ¶æ…‹ç¢ºèª | `sc query MyService`                                          |

---

ğŸ’¬
ã‚‚ã—ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ã§å®Ÿè¡Œã€ã‚„ã€Œå¼•æ•°ä»˜ãã§ç™»éŒ²ã€ã—ãŸã„ãªã‚‰ã€
ãã®ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ`binPath` ã«å¼•æ•°è¿½åŠ ã€`obj=` ã§å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼æŒ‡å®šï¼‰ã‚‚æ›¸ã‘ã¾ã™ã€‚
ã©ã¡ã‚‰ã«è¿‘ã„ã‚±ãƒ¼ã‚¹ã§ã™ã‹ï¼Ÿ
