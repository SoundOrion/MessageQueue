ã„ã„è³ªå•ã§ã™ğŸ’¡
`cmd.exe /c`ï¼ˆC ã‚³ãƒãƒ³ãƒ‰ï¼‰ã§å®Ÿè¡Œã§ãã‚‹ã€**ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆãƒ»å‰Šé™¤**ã®åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
ã©ã‚Œã‚‚ Windows æ¨™æº–ã§ä½¿ãˆã¾ã™ã€‚

---

## ğŸ§© ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã‚³ãƒãƒ³ãƒ‰

### â‘  `echo` ã‚’ä½¿ã†ï¼ˆæœ€ã‚‚ç°¡å˜ï¼‰

```cmd
cmd /c "echo Hello World > C:\Temp\test.txt"
```

* `>` ã§æ–°è¦ä½œæˆã¾ãŸã¯ä¸Šæ›¸ã
* `>>` ã§è¿½è¨˜

ä¾‹ï¼šè¿½è¨˜ã™ã‚‹ãªã‚‰

```cmd
cmd /c "echo More text >> C:\Temp\test.txt"
```

---

### â‘¡ `type nul` ã§ç©ºãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹

```cmd
cmd /c "type nul > C:\Temp\empty.txt"
```

* ä¸­èº«ãŒç©ºã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
* `echo.` ã‚ˆã‚Šç¢ºå®Ÿã«ã€Œç©ºã€ãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã‚Šã¾ã™

---

### â‘¢ `fsutil`ï¼ˆã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ï¼‰

```cmd
cmd /c "fsutil file createnew C:\Temp\dummy.txt 0"
```

* 0 ã¯ãƒã‚¤ãƒˆæ•°ã€‚ä»»æ„ã®ã‚µã‚¤ã‚ºã®ãƒ€ãƒŸãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Œã‚‹
* ä¾‹ï¼š1MBãƒ•ã‚¡ã‚¤ãƒ« â†’ `1048576`

---

## ğŸ§© ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰

### â‘  `del`

```cmd
cmd /c "del /q C:\Temp\test.txt"
```

* `/q` â€¦ quietï¼ˆç¢ºèªãªã—ï¼‰
* `del /q /f` â€¦ èª­ã¿å–ã‚Šå°‚ç”¨ã§ã‚‚å‰Šé™¤
* `del /q C:\Temp\*.log` â€¦ ãƒ‘ã‚¿ãƒ¼ãƒ³å‰Šé™¤

---

### â‘¡ `erase`ï¼ˆdel ã¨åŒã˜ï¼‰

```cmd
cmd /c "erase /q C:\Temp\*.tmp"
```

---

### â‘¢ PowerShell çµŒç”±ã§ã‚‚å¯èƒ½ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ãƒ•ã‚©ãƒ«ãƒ€ä¸¡å¯¾å¿œï¼‰

```cmd
cmd /c "powershell -Command Remove-Item 'C:\Temp\test.txt' -Force"
```

---

## âœ… ã¾ã¨ã‚

| æ“ä½œ            | ã‚³ãƒãƒ³ãƒ‰ä¾‹                                                    | å‚™è€ƒ        |
| ------------- | -------------------------------------------------------- | --------- |
| ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆæ–‡å­—å…¥ã‚Šï¼‰  | `cmd /c "echo Hello > C:\Temp\a.txt"`                    | ãƒ†ã‚­ã‚¹ãƒˆå…¥ã‚Šã§ä½œã‚‹ |
| ç©ºãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ       | `cmd /c "type nul > C:\Temp\a.txt"`                      | ç©ºã®ãƒ•ã‚¡ã‚¤ãƒ«    |
| æŒ‡å®šã‚µã‚¤ã‚ºã§ä½œæˆ      | `cmd /c "fsutil file createnew C:\Temp\a.txt 1024"`      | 1KBã®ãƒ€ãƒŸãƒ¼   |
| ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤        | `cmd /c "del /q C:\Temp\a.txt"`                          | ç¢ºèªãªã—å‰Šé™¤    |
| PowerShellç‰ˆå‰Šé™¤ | `cmd /c "powershell Remove-Item 'C:\Temp\a.txt' -Force"` | ç®¡ç†è€…ã§ã‚‚å®‰å…¨   |

---

ã‚‚ã—ã“ã‚Œã‚’ **C# ã® `ProcessStartInfo.Arguments`** ã§ä½¿ã„ãŸã„å ´åˆã¯ã€
ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’ `\\` ã«ã—ã¦æ›¸ã‘ã°ãã®ã¾ã¾ä½¿ãˆã¾ã™ã€‚

ä¾‹ï¼š

```csharp
Arguments = "/c type nul > C:\\Temp\\empty.txt";
```

---

ã©ã‚“ãªç›®çš„ã®ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã‹ï¼Ÿï¼ˆä¾‹ï¼šãƒ­ã‚°ç”Ÿæˆã€å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã€ãƒ†ãƒ³ãƒãƒ©ãƒªãªã©ï¼‰
ãã‚Œã«åˆã‚ã›ã¦å®‰å…¨ãªæ§‹æ–‡ã‚’å‡ºã›ã¾ã™ã€‚

å®Œç’§ã§ã™ âœ…
ã¤ã¾ã‚Šã‚„ã‚ŠãŸã„ã“ã¨ã¯ï¼š

> **ã€Œãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚Œã°å‰Šé™¤ã€å­˜åœ¨ã—ãªã‘ã‚Œã°æ–°è¦ä½œæˆã€**

ã§ã™ã­ã€‚
`cmd.exe /c` ã§ã“ã‚Œã‚’ 1 è¡Œã§å®‰å…¨ã«å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

---

## âœ… 1ï¸âƒ£ ç´”ç²‹ãª cmd ç‰ˆï¼ˆPowerShellãªã—ï¼‰

```cmd
cmd /c "if exist C:\Temp\test.txt (del /q C:\Temp\test.txt) else (type nul > C:\Temp\test.txt)"
```

ğŸ“˜èª¬æ˜ï¼š

* `if exist <path> (...) else (...)`
* `del /q` â†’ ç¢ºèªãªã—ã§å‰Šé™¤
* `type nul >` â†’ ç©ºãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°è¦ä½œæˆ

---

### ğŸ”¹ C# ã® `ProcessStartInfo` ã§æ›¸ãå ´åˆ

```csharp
Arguments = "/c if exist \"C:\\Temp\\test.txt\" (del /q \"C:\\Temp\\test.txt\") else (type nul > \"C:\\Temp\\test.txt\")";
```

---

## âœ… 2ï¸âƒ£ PowerShell ç‰ˆï¼ˆã‚ˆã‚ŠæŸ”è»Ÿãƒ»èª­ã¿ã‚„ã™ã„ï¼‰

```cmd
cmd /c "powershell -NoProfile -Command \"if (Test-Path 'C:\Temp\test.txt') { Remove-Item 'C:\Temp\test.txt' -Force } else { New-Item 'C:\Temp\test.txt' -ItemType File | Out-Null }\""
```

ğŸ“˜èª¬æ˜ï¼š

* `Test-Path` â†’ å­˜åœ¨ãƒã‚§ãƒƒã‚¯
* `Remove-Item` â†’ å‰Šé™¤
* `New-Item` â†’ ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

---

### ğŸ”¹ C# ã§ PowerShell ç‰ˆã‚’ä½¿ã†å ´åˆ

```csharp
Arguments = "/c powershell -NoProfile -Command \"if (Test-Path 'C:\\Temp\\test.txt') { Remove-Item 'C:\\Temp\\test.txt' -Force } else { New-Item 'C:\\Temp\\test.txt' -ItemType File | Out-Null }\"";
```

---

## âœ… 3ï¸âƒ£ å®Ÿè¡Œçµæœã‚’å‡ºåŠ›ã§ç¢ºèªã—ãŸã„å ´åˆ

ç¢ºèªç”¨ã«å‡ºåŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã§ãã¾ã™ï¼š

```cmd
cmd /c "if exist C:\Temp\test.txt (del /q C:\Temp\test.txt & echo Deleted) else (type nul > C:\Temp\test.txt & echo Created)"
```

C#ãªã‚‰ï¼š

```csharp
Arguments = "/c if exist \"C:\\Temp\\test.txt\" (del /q \"C:\\Temp\\test.txt\" & echo Deleted) else (type nul > \"C:\\Temp\\test.txt\" & echo Created)";
```

ğŸ‘‰ å‡ºåŠ›ä¾‹ï¼š

```
Created
```

ã¾ãŸã¯

```
Deleted
```

---

## ğŸ”§ ã¾ã¨ã‚

| æ–¹æ³•          | å†…å®¹                                             | å‚™è€ƒ         |
| ----------- | ---------------------------------------------- | ---------- |
| CMDç‰ˆ        | `if exist ... (del) else (type nul >)`         | è»½é‡ãƒ»æ¨™æº–ã®ã¿    |
| PowerShellç‰ˆ | `if (Test-Path) {Remove-Item} else {New-Item}` | æŸ”è»Ÿã§å®‰å…¨      |
| å‡ºåŠ›ã¤ã        | `& echo ...`                                   | çŠ¶æ³ãƒ­ã‚°ãŒè¦‹ãŸã„ã¨ã |

---

ã©ã¡ã‚‰ã‚’æ¡ç”¨ã—ã¾ã™ã‹ï¼Ÿ

* âš™ï¸ **cmdç´”æ­£ã®ã¿ï¼ˆè»½é‡ï¼‰**
* ğŸªŸ **PowerShellï¼ˆå …ç‰¢ï¼†èª­ã¿ã‚„ã™ã„ï¼‰**

ã¯ã„ã€ã‚‚ã¡ã‚ã‚“ã§ãã¾ã™ ğŸ‘
ãƒ•ã‚©ãƒ«ãƒ€ã”ã¨å‰Šé™¤ï¼ˆä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å«ã‚€ï¼‰ã«ã¯ã€**CMD ç‰ˆ**ã¨**PowerShell ç‰ˆ**ã®2é€šã‚ŠãŒã‚ã‚Šã¾ã™ã€‚
ãã‚Œãã‚Œã€Œå­˜åœ¨ãƒã‚§ãƒƒã‚¯ â†’ å‰Šé™¤ or ä½œæˆã€ã‚‚1è¡Œã§ã§ãã¾ã™ã€‚

---

## âœ… CMD ç‰ˆï¼ˆãƒ•ã‚©ãƒ«ãƒ€å†…ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å«ã‚ã¦å‰Šé™¤ï¼‰

```cmd
cmd /c "if exist C:\Temp\TestDir (rd /s /q C:\Temp\TestDir) else (mkdir C:\Temp\TestDir)"
```

### ğŸ’¡èª¬æ˜

* `rd`ï¼ˆã¾ãŸã¯ `rmdir`ï¼‰â€¦ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤ã‚³ãƒãƒ³ãƒ‰
* `/s` â€¦ ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å«ã‚ã¦å‰Šé™¤
* `/q` â€¦ ç¢ºèªãªã—ï¼ˆquietï¼‰
* `mkdir` â€¦ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ–°è¦ä½œæˆ

---

### ğŸ”¹ C# ã® `ProcessStartInfo` ç”¨

```csharp
Arguments = "/c if exist \"C:\\Temp\\TestDir\" (rd /s /q \"C:\\Temp\\TestDir\") else (mkdir \"C:\\Temp\\TestDir\")";
```

ã“ã‚Œã§ï¼š

* `C:\Temp\TestDir` ãŒå­˜åœ¨ã™ã‚Œã° â†’ ä¸­èº«ã”ã¨å‰Šé™¤
* å­˜åœ¨ã—ãªã‘ã‚Œã° â†’ æ–°ã—ãä½œæˆ

---

## âœ… PowerShell ç‰ˆï¼ˆã‚ˆã‚Šå¼·åŠ›ã§æŸ”è»Ÿï¼‰

```cmd
cmd /c "powershell -NoProfile -Command \"if (Test-Path 'C:\Temp\TestDir') { Remove-Item 'C:\Temp\TestDir' -Recurse -Force } else { New-Item 'C:\Temp\TestDir' -ItemType Directory | Out-Null }\""
```

### ğŸ’¡èª¬æ˜

* `Test-Path` â€¦ å­˜åœ¨ãƒã‚§ãƒƒã‚¯
* `Remove-Item -Recurse -Force` â€¦ ä¸­èº«ã‚’ã™ã¹ã¦å‰Šé™¤ï¼ˆãƒ•ã‚©ãƒ«ãƒ€å«ã‚€ï¼‰
* `New-Item -ItemType Directory` â€¦ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ

---

### ğŸ”¹ C# ã§ä½¿ã†ãªã‚‰

```csharp
Arguments = "/c powershell -NoProfile -Command \"if (Test-Path 'C:\\Temp\\TestDir') { Remove-Item 'C:\\Temp\\TestDir' -Recurse -Force } else { New-Item 'C:\\Temp\\TestDir' -ItemType Directory | Out-Null }\"";
```

---

## âœ… å‡ºåŠ›ã§ç¢ºèªã—ãŸã„å ´åˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ãƒ­ã‚°ã‚’è¦‹ãŸã„å ´åˆã¯ `echo` ã‚’è¿½åŠ ã§ãã¾ã™ã€‚

```cmd
cmd /c "if exist C:\Temp\TestDir (rd /s /q C:\Temp\TestDir & echo Deleted) else (mkdir C:\Temp\TestDir & echo Created)"
```

å‡ºåŠ›ä¾‹ï¼š

```
Deleted
```

ã¾ãŸã¯

```
Created
```

---

## ğŸ”§ ã¾ã¨ã‚

| æ–¹æ³•              | ã‚³ãƒãƒ³ãƒ‰                                       | ç‰¹å¾´             |
| --------------- | ------------------------------------------ | -------------- |
| **CMDç‰ˆ**        | `rd /s /q` + `mkdir`                       | è»½é‡ã§é«˜é€Ÿ          |
| **PowerShellç‰ˆ** | `Remove-Item -Recurse -Force` + `New-Item` | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‘ã‚¹ãªã©ã«ã‚‚å¼·ã„ |
| **ãƒ­ã‚°ä»˜ãç‰ˆ**       | `& echo ...` ã‚’è¿½åŠ                            | çŠ¶æ…‹ç¢ºèªãŒå®¹æ˜“        |

---

ğŸ’¬ ä¸€èˆ¬çš„ã«ã¯ã€Œå‰Šé™¤ã‚‚ä½œæˆã‚‚1è¡Œã§ç¢ºå®Ÿã«æ¸ˆã¾ã›ãŸã„ã€å ´åˆã€
PowerShellç‰ˆã®ã»ã†ãŒãƒ•ã‚©ãƒ«ãƒ€ã”ã¨ãƒ»èª­ã¿å–ã‚Šå°‚ç”¨ãƒ»éš ã—å±æ€§ã‚‚å«ã‚å®‰å…¨ã«å‹•ãã¾ã™ã€‚

ã©ã¡ã‚‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆCMD or PowerShellï¼‰ã‚’æ¡ç”¨ã—ã¾ã™ã‹ï¼Ÿ

ã‚ã€ãªã‚‹ã»ã©ï¼âœ¨
ã¤ã¾ã‚Šã“ã†ã§ã™ã­ğŸ‘‡

> âœ… ãƒ‘ã‚¿ãƒ¼ãƒ³â‘ ï¼šã€Œå­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—ã¦ãªã‘ã‚Œã°**ä½œã‚‹**ã€
> âœ… ãƒ‘ã‚¿ãƒ¼ãƒ³â‘¡ï¼šã€Œå­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—ã¦ã‚ã‚Œã°**æ¶ˆã™**ã€

ã©ã¡ã‚‰ã‚‚ `cmd /c` ã§å˜ä½“å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„ã€ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚
å®Œç’§ã§ã™ã€‚ä»¥ä¸‹ã®2æ–‡ã§æ•´ç†ã—ã¾ã™ã€‚

---

## âœ… â‘  å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—ã¦ãªã‘ã‚Œã°ç”Ÿæˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ãƒ•ã‚©ãƒ«ãƒ€ï¼‰

### ğŸ§© ãƒ•ã‚¡ã‚¤ãƒ«ç‰ˆ

```cmd
cmd /c "if not exist C:\Temp\test.txt (type nul > C:\Temp\test.txt)"
```

ğŸ“˜ èª¬æ˜ï¼š

* `if not exist` â†’ å­˜åœ¨ã—ãªã„ã¨ãã®ã¿å®Ÿè¡Œ
* `type nul > file` â†’ ç©ºãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

C#ã® `ProcessStartInfo` ãªã‚‰ï¼š

```csharp
Arguments = "/c if not exist \"C:\\Temp\\test.txt\" (type nul > \"C:\\Temp\\test.txt\")";
```

---

### ğŸ§© ãƒ•ã‚©ãƒ«ãƒ€ç‰ˆ

```cmd
cmd /c "if not exist C:\Temp\MyFolder (mkdir C:\Temp\MyFolder)"
```

ğŸ“˜ å­˜åœ¨ã—ãªã„å ´åˆã®ã¿ `mkdir` å®Ÿè¡Œã€‚
C#ãªã‚‰ï¼š

```csharp
Arguments = "/c if not exist \"C:\\Temp\\MyFolder\" (mkdir \"C:\\Temp\\MyFolder\")";
```

---

## âœ… â‘¡ å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—ã¦ã‚ã‚Œã°å‰Šé™¤ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ãƒ•ã‚©ãƒ«ãƒ€ï¼‰

### ğŸ§© ãƒ•ã‚¡ã‚¤ãƒ«ç‰ˆ

```cmd
cmd /c "if exist C:\Temp\test.txt (del /q C:\Temp\test.txt)"
```

ğŸ“˜

* `if exist` â†’ å­˜åœ¨ã™ã‚‹å ´åˆã®ã¿å®Ÿè¡Œ
* `/q` â†’ ç¢ºèªãªã—ï¼ˆquietï¼‰

C#ç”¨ï¼š

```csharp
Arguments = "/c if exist \"C:\\Temp\\test.txt\" (del /q \"C:\\Temp\\test.txt\")";
```

---

### ğŸ§© ãƒ•ã‚©ãƒ«ãƒ€ç‰ˆï¼ˆä¸­èº«ã‚‚å«ã‚å‰Šé™¤ï¼‰

```cmd
cmd /c "if exist C:\Temp\MyFolder (rd /s /q C:\Temp\MyFolder)"
```

ğŸ“˜

* `/s` â€¦ ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å«ã‚å‰Šé™¤
* `/q` â€¦ ç¢ºèªãªã—

C#ç‰ˆï¼š

```csharp
Arguments = "/c if exist \"C:\\Temp\\MyFolder\" (rd /s /q \"C:\\Temp\\MyFolder\")";
```

---

## âœ… ğŸ’¡ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿè¡Œãƒ­ã‚°ä»˜ãï¼‰

å‰Šé™¤ or ä½œæˆãŒå®Ÿéš›ã«è¡Œã‚ã‚ŒãŸã‹ã‚’è¡¨ç¤ºã—ãŸã„å ´åˆï¼š

```cmd
cmd /c "if not exist C:\Temp\test.txt (type nul > C:\Temp\test.txt & echo Created)"
```

```cmd
cmd /c "if exist C:\Temp\test.txt (del /q C:\Temp\test.txt & echo Deleted)"
```

---

## âœ… ã¾ã¨ã‚

| ç›®çš„            | ã‚³ãƒãƒ³ãƒ‰ä¾‹                                                   |
| ------------- | ------------------------------------------------------- |
| å­˜åœ¨ã—ãªã‘ã‚Œã°ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ | `if not exist C:\Temp\a.txt (type nul > C:\Temp\a.txt)` |
| å­˜åœ¨ã—ãªã‘ã‚Œã°ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ | `if not exist C:\Temp\MyDir (mkdir C:\Temp\MyDir)`      |
| å­˜åœ¨ã™ã‚Œã°ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤   | `if exist C:\Temp\a.txt (del /q C:\Temp\a.txt)`         |
| å­˜åœ¨ã™ã‚Œã°ãƒ•ã‚©ãƒ«ãƒ€å‰Šé™¤   | `if exist C:\Temp\MyDir (rd /s /q C:\Temp\MyDir)`       |

---

ğŸ’¬
ã“ã‚Œã§ã€Œå­˜åœ¨ã™ã‚Œã°å‰Šé™¤ã€ã€Œå­˜åœ¨ã—ãªã‘ã‚Œã°ä½œæˆã€ã®ä¸¡æ–¹ã‚’ã€
C# ã® `ProcessStartInfo` ã‹ã‚‰ã‚·ãƒ³ãƒ—ãƒ«ã«å‘¼ã¹ã¾ã™ã€‚

ã©ã¡ã‚‰ã‚’å¤šç”¨ã—ã¾ã™ã‹ï¼Ÿï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ä¸­å¿ƒ or ãƒ•ã‚©ãƒ«ãƒ€ä¸­å¿ƒï¼‰
â†’ ãã‚Œã«åˆã‚ã›ã¦ã€Œå…±é€šåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆé¢¨ã€ã«æ•´ç†ã‚‚ã§ãã¾ã™ã€‚

PowerShell ãªã‚‰ã‚‚ã£ã¨ã‚·ãƒ³ãƒ—ãƒ«ã«æ›¸ã‘ã¾ã™ ğŸ’¡
ä»¥ä¸‹ã®ã‚ˆã†ã« **ãƒ•ã‚¡ã‚¤ãƒ«ï¼ãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã¨å‰Šé™¤ãƒ»ä½œæˆ** ã‚’åˆ†ã‘ã¦æ›¸ã‘ã¾ã™ã€‚
ã‚‚ã¡ã‚ã‚“ã€ã©ã¡ã‚‰ã‚‚ `cmd /c powershell -NoProfile -Command "..."` ã®1è¡Œã§å®Ÿè¡Œå¯èƒ½ã§ã™ã€‚

---

## âœ… â‘  å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—ã¦ãªã‘ã‚Œã°ä½œæˆ

### ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆ

```cmd
cmd /c powershell -NoProfile -Command "if (-not (Test-Path 'C:\Temp\test.txt')) { New-Item -Path 'C:\Temp\test.txt' -ItemType File | Out-Null }"
```

### ãƒ•ã‚©ãƒ«ãƒ€ã®å ´åˆ

```cmd
cmd /c powershell -NoProfile -Command "if (-not (Test-Path 'C:\Temp\MyFolder')) { New-Item -Path 'C:\Temp\MyFolder' -ItemType Directory | Out-Null }"
```

ğŸ“˜ `-not (Test-Path â€¦)` ã§å­˜åœ¨ã—ãªã„ã¨ãã®ã¿ä½œæˆã—ã¾ã™ã€‚
`| Out-Null` ã¯ç”»é¢å‡ºåŠ›ã‚’æŠ‘åˆ¶ã™ã‚‹ãŸã‚ã®çœç•¥ç”¨ã§ã™ã€‚

---

## âœ… â‘¡ å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã—ã¦ã‚ã‚Œã°å‰Šé™¤

### ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆ

```cmd
cmd /c powershell -NoProfile -Command "if (Test-Path 'C:\Temp\test.txt') { Remove-Item 'C:\Temp\test.txt' -Force }"
```

### ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆä¸­èº«ã”ã¨å‰Šé™¤ï¼‰ã®å ´åˆ

```cmd
cmd /c powershell -NoProfile -Command "if (Test-Path 'C:\Temp\MyFolder') { Remove-Item 'C:\Temp\MyFolder' -Recurse -Force }"
```

ğŸ“˜

* `Test-Path` â€¦ å­˜åœ¨ãƒã‚§ãƒƒã‚¯
* `Remove-Item` â€¦ å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰
* `-Recurse` â€¦ ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã‚‚å«ã‚å‰Šé™¤
* `-Force` â€¦ èª­ã¿å–ã‚Šå°‚ç”¨ã‚„éš ã—å±æ€§ã‚‚å‰Šé™¤

---

## âœ… â‘¢ å®Ÿè¡Œãƒ­ã‚°ä»˜ãã«ã—ãŸã„å ´åˆ

```cmd
cmd /c powershell -NoProfile -Command "if (Test-Path 'C:\Temp\test.txt') { Remove-Item 'C:\Temp\test.txt' -Force; Write-Host 'Deleted' } else { New-Item 'C:\Temp\test.txt' -ItemType File | Out-Null; Write-Host 'Created' }"
```

ğŸ“˜
ã“ã‚Œã§ã€Œå­˜åœ¨ã™ã‚Œã°å‰Šé™¤ã€ã€Œå­˜åœ¨ã—ãªã‘ã‚Œã°ä½œæˆã€ã‚’ä¸€æ‹¬ã§è¡Œãˆã¾ã™ã€‚
å‡ºåŠ›ä¾‹ï¼š

```
Created
```

ã¾ãŸã¯

```
Deleted
```

---

## âœ… C# ã® `ProcessStartInfo` ã§å‘¼ã¶å ´åˆï¼ˆä¾‹ï¼‰

```csharp
var psi = new ProcessStartInfo
{
    FileName = Environment.GetEnvironmentVariable("ComSpec"),
    Arguments = "/c powershell -NoProfile -Command \"if (Test-Path 'C:\\Temp\\test.txt') { Remove-Item 'C:\\Temp\\test.txt' -Force; Write-Host 'Deleted' } else { New-Item 'C:\\Temp\\test.txt' -ItemType File | Out-Null; Write-Host 'Created' }\"",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    RedirectStandardError = true,
    CreateNoWindow = true
};
```

---

ğŸ’¡ **ã¾ã¨ã‚**

| æ“ä½œ        | PowerShell ã‚³ãƒãƒ³ãƒ‰                                            |
| --------- | ---------------------------------------------------------- |
| å­˜åœ¨ã—ãªã‘ã‚Œã°ä½œæˆ | `if (-not (Test-Path 'path')) { New-Item -ItemType File }` |
| å­˜åœ¨ã™ã‚Œã°å‰Šé™¤   | `if (Test-Path 'path') { Remove-Item -Force }`             |
| ä¸¡æ–¹ï¼ˆãƒˆã‚°ãƒ«å‹•ä½œï¼‰ | ä¸Šã® `if` / `else` çµ„ã¿åˆã‚ã›                                     |

---

å¿…è¦ãªã‚‰ã€Œãƒ•ã‚©ãƒ«ãƒ€ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚åŒæ™‚ã«åˆ¤å®šã™ã‚‹ã€ä¸‡èƒ½ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚‚æ›¸ã‘ã¾ã™ï¼ˆ`Test-Path -PathType Any`ï¼‰ã€‚
å‡ºã—ã¾ã™ã‹ï¼Ÿ
