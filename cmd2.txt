ã¯ã„ï¼ğŸ‘‹
Windowsã® **ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã®ä¸€è¦§**ï¼ˆç™»éŒ²æ¸ˆã¿ã‚¿ã‚¹ã‚¯ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ»PowerShellãƒ»C# ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ç´¹ä»‹ã—ã¾ã™ã€‚

---

## âœ… â‘  CMD ã‚³ãƒãƒ³ãƒ‰ã§ä¸€è¦§ã‚’å‡ºã™

### å…¨ã‚¿ã‚¹ã‚¯ä¸€è¦§

```cmd
schtasks /query /fo LIST /v
```

* `/query` â€¦ ä¸€è¦§ã‚’è¡¨ç¤º
* `/fo LIST` â€¦ è¡¨ç¤ºå½¢å¼ï¼ˆLIST, TABLE, CSV ãªã©é¸ã¹ã‚‹ï¼‰
* `/v` â€¦ è©³ç´°è¡¨ç¤ºï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»æœ€çµ‚å®Ÿè¡Œçµæœãªã©ï¼‰

ä¾‹ï¼šãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§ç°¡æ½”ã«è¦‹ã‚‹ãªã‚‰

```cmd
schtasks /query /fo TABLE
```

---

### ç‰¹å®šãƒ•ã‚©ãƒ«ãƒ€ï¼ˆä¾‹ï¼šMicrosoft é…ä¸‹ï¼‰ã ã‘è¦‹ã‚‹

```cmd
schtasks /query /tn "\Microsoft\Windows\Defrag"
```

---

### XMLå‡ºåŠ›ã—ãŸã„å ´åˆ

```cmd
schtasks /query /xml ONE > task.xml
```

---

## âœ… â‘¡ PowerShell ç‰ˆï¼ˆæŸ”è»Ÿï¼†ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ï¼‰

```powershell
Get-ScheduledTask | Select-Object TaskName, TaskPath, State, LastRunTime, NextRunTime
```

å‡ºåŠ›ä¾‹ï¼š

```
TaskName       TaskPath                      State   LastRunTime           NextRunTime
---------       --------                      -----   -----------           ------------
GoogleUpdateTaskMachineUA \                  Ready   2025/10/24 10:00:00   2025/10/24 22:00:00
MyBackupScript             \MyTasks\          Running 2025/10/24 03:00:00   2025/10/25 03:00:00
```

---

### ç‰¹å®šã®åå‰ã§çµã‚Šè¾¼ã¿

```powershell
Get-ScheduledTask | Where-Object {$_.TaskName -like '*Backup*'}
```

---

### C# ã® `ProcessStartInfo` ã‹ã‚‰å‘¼ã³å‡ºã™å ´åˆ

```csharp
var psi = new ProcessStartInfo
{
    FileName = Environment.GetEnvironmentVariable("ComSpec"),
    Arguments = "/c schtasks /query /fo TABLE /v",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    CreateNoWindow = true
};

using var p = Process.Start(psi);
string output = p.StandardOutput.ReadToEnd();
p.WaitForExit();

Console.WriteLine(output);
```

---

## âœ… â‘¢ PowerShell ã®çµæœã‚’CSVå½¢å¼ã§å‡ºåŠ›ã—ãŸã„ãªã‚‰

```powershell
Get-ScheduledTask |
Select-Object TaskName, TaskPath, State, LastRunTime, NextRunTime |
Export-Csv "C:\Temp\Tasks.csv" -NoTypeInformation -Encoding UTF8
```

---

## ğŸ§© ä¸€è¦§å–å¾—ã«é–¢ã™ã‚‹è£œè¶³

* ä¸€éƒ¨ã‚¿ã‚¹ã‚¯ï¼ˆç‰¹ã« `\Microsoft\Windows\` ä»¥ä¸‹ï¼‰ã¯ **ç®¡ç†è€…æ¨©é™ãŒå¿…è¦** ã§ã™ã€‚
* ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§å‹•ã„ã¦ã„ã‚‹å ´åˆã€ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚¿ã‚¹ã‚¯ã¯åˆ¶é™ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
* `schtasks /query` ã¯å¤ã„Windowsã§ã‚‚ä½¿ãˆã¾ã™ãŒã€`Get-ScheduledTask` ã¯ Windows 8 / Server 2012 ä»¥é™ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

---

ğŸ’¬ ã©ã®å½¢å¼ã§ä¸€è¦§ã‚’å–ã‚ŠãŸã„ã§ã™ã‹ï¼Ÿ

* âœ… ç”»é¢ã«å‡ºåŠ›ï¼ˆcmdï¼‰
* ğŸ§¾ CSVãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
* ğŸ§  C#ã®ä¸­ã§é…åˆ—ã¨ã—ã¦å‡¦ç†ï¼ˆçµæœã‚’ãƒ‘ãƒ¼ã‚¹ï¼‰

ä¼ã‚ã‚Šã¾ã™ ğŸ˜Š
ã¤ã¾ã‚Šã€ŒWindows ã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ **â€œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªåˆ†ã§è¨­å®šã—ãŸã‚¿ã‚¹ã‚¯â€ã ã‘**ï¼ˆã‚·ã‚¹ãƒ†ãƒ æ¨™æº–ã‚¿ã‚¹ã‚¯ã‚’é™¤ãï¼‰ã€ã‚’ä¸€è¦§ã—ãŸã„ã€ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚

---

## âœ… çµè«–ï¼šã‚ã‚‹ç¨‹åº¦ã¯**çµã‚Šè¾¼ã¿å¯èƒ½**ã§ã™ï¼ˆå®Œå…¨ã§ã¯ãªã„ï¼‰

Windowsã«ã¯ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã‚¿ã‚¹ã‚¯ã€ã¨ã„ã†æ˜ç¢ºãªã‚¿ã‚°ãŒãªã„ãŸã‚ã€
**ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç™»éŒ²ã—ãŸã‚¿ã‚¹ã‚¯ã‚‰ã—ãã‚‚ã®ã‚’æ¨å®šã—ã¦æŠ½å‡º**ã™ã‚‹å½¢ã«ãªã‚Šã¾ã™ã€‚

---

## âœ… æ–¹æ³•â‘ ï¼šPowerShellã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã‚¿ã‚¹ã‚¯ã‚’æŠ½å‡º

```powershell
Get-ScheduledTask |
Where-Object {
    $_.TaskPath -notlike "\Microsoft*" -and
    $_.TaskPath -notlike "\Windows*" -and
    $_.TaskPath -notlike "\*" -and
    $_.Principal.UserId -ne $null
} |
Select-Object TaskName, TaskPath, State, @{Name="User";Expression={$_.Principal.UserId}}
```

### ğŸ’¡ãƒã‚¤ãƒ³ãƒˆ

* `TaskPath -notlike "\Microsoft*"` ã§ã€Windowsæ¨™æº–ã‚¿ã‚¹ã‚¯ã‚’é™¤å¤–
* `Principal.UserId` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å®Ÿè¡Œï¼‰ã ã‘æ®‹ã™
* å‡ºåŠ›ä¾‹ï¼š

```
TaskName     TaskPath      State   User
---------     --------      -----   ----
MyBackup      \             Ready   DESKTOP-ABC\User
AppUpdater    \CustomTasks\ Ready   DESKTOP-ABC\User
```

---

## âœ… æ–¹æ³•â‘¡ï¼šschtasksã‚³ãƒãƒ³ãƒ‰ã§æŠ½å‡ºï¼ˆCMDã§ã‚‚ä½¿ãˆã‚‹ï¼‰

```cmd
schtasks /query /fo LIST /v | findstr /V "Microsoft\Windows"
```

* `/v` ã¯è©³ç´°è¡¨ç¤ºï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚‚å«ã¾ã‚Œã‚‹ï¼‰
* `findstr /V "Microsoft\Windows"` ã§ã‚·ã‚¹ãƒ†ãƒ ã‚¿ã‚¹ã‚¯ã‚’é™¤å¤–
* ãŸã ã—å®Œå…¨ã«ã¯é™¤å¤–ã§ããšã€\Microsofté…ä¸‹ä»¥å¤–ã«ã‚‚ã‚·ã‚¹ãƒ†ãƒ ã‚¿ã‚¹ã‚¯ãŒæ··ã–ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™

---

## âœ… æ–¹æ³•â‘¢ï¼šç¢ºå®Ÿã«â€œè‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼â€ãŒè¨­å®šã—ãŸã‚‚ã®ã‚’æŠ½å‡º

ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åã§çµã‚‹ï¼‰

PowerShellä¾‹ï¼š

```powershell
$user = "$env:COMPUTERNAME\$env:USERNAME"
Get-ScheduledTask | Where-Object { $_.Principal.UserId -eq $user } |
Select-Object TaskName, TaskPath, State
```

ğŸ’¡ ã“ã‚Œãªã‚‰ã€Œè‡ªåˆ†ã®Windowsã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ç™»éŒ²ã—ãŸã‚¿ã‚¹ã‚¯ã€ã ã‘å‡ºã¾ã™ã€‚

---

## âœ… C# ã‹ã‚‰å‘¼ã³å‡ºã™ä¾‹

```csharp
var psi = new ProcessStartInfo
{
    FileName = Environment.GetEnvironmentVariable("ComSpec"),
    Arguments = "/c powershell -NoProfile -Command \"Get-ScheduledTask | Where-Object { $_.TaskPath -notlike '\\Microsoft*' -and $_.Principal.UserId -ne $null } | Select-Object TaskName,TaskPath,State,@{Name='User';Expression={$_.Principal.UserId}}\"",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    CreateNoWindow = true
};
```

---

## âœ… ã¾ã¨ã‚

| æ–¹æ³•             | ã‚³ãƒãƒ³ãƒ‰                         | ç‰¹å¾´                                                      |                |
| -------------- | ---------------------------- | ------------------------------------------------------- | -------------- |
| PowerShellï¼ˆæ¨å¥¨ï¼‰ | `Get-ScheduledTask           | Where-Object { $_.TaskPath -notlike '\Microsoft*' }`    | ã‚·ã‚¹ãƒ†ãƒ ã‚¿ã‚¹ã‚¯é™¤å¤–ã«æœ€é©   |
| CMD            | `schtasks /query /fo LIST /v | findstr /V Microsoft\Windows`                           | ã©ã®Windowsã§ã‚‚ä½¿ãˆã‚‹ |
| ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼         | `Get-ScheduledTask           | Where-Object { $_.Principal.UserId -eq $env:USERNAME }` | è‡ªåˆ†ãŒä½œã£ãŸã‚‚ã®ã ã‘     |

---

ã‚‚ã—ã€Œç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œã£ãŸã‚¿ã‚¹ã‚¯ã ã‘ã€ã‚„
ã€Œç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆä¾‹ï¼šAdministratorï¼‰ã®ã‚¿ã‚¹ã‚¯ã ã‘ã€
ã«çµã‚ŠãŸã„å ´åˆã€PowerShellç‰ˆãŒæœ€ã‚‚ç¢ºå®Ÿã§ã™ã€‚

---

å¿…è¦ãªã‚‰ãã®ä¸€è¦§ã‚’ **CSV** ã‚„ **JSON** ã«å‡ºåŠ›ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚‚æ›¸ã‘ã¾ã™ã€‚
å‡ºåŠ›å½¢å¼ã¯ã©ã†ã—ãŸã„ã§ã™ã‹ï¼Ÿï¼ˆä¾‹ï¼šCSV, ãƒ†ãƒ¼ãƒ–ãƒ«, æ¨™æº–å‡ºåŠ›ï¼‰

OKã§ã™ï¼ğŸ’ª
ã€ŒPowerShellã‚„schtasksã‚’å…¨éƒ¨ `cmd /c` ã‹ã‚‰å‘¼ã³å‡ºã—ãŸã„ã€å ´åˆã®å®Ÿç”¨ã‚³ãƒãƒ³ãƒ‰ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚
å…¨éƒ¨ **1 è¡Œã§å®Ÿè¡Œå¯èƒ½** ã§ã™ã€‚

---

## âœ… 1ï¸âƒ£ ã€Œã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã€ã‚’ä¸€è¦§ï¼ˆè©³ç´°å«ã‚€ï¼‰

```cmd
cmd /c "schtasks /query /fo TABLE /v"
```

ğŸ“

* `/fo TABLE` â†’ è¡¨å½¢å¼
* `/v` â†’ è©³ç´°ï¼ˆå®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»çŠ¶æ…‹ãªã©ï¼‰

---

## âœ… 2ï¸âƒ£ ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã—ãŸã‚¿ã‚¹ã‚¯ã€ã ã‘æŠ½å‡ºï¼ˆã‚·ã‚¹ãƒ†ãƒ ç³»ã‚’é™¤å¤–ï¼‰

```cmd
cmd /c "schtasks /query /fo TABLE /v | findstr /I /V \"Microsoft\\Windows\""
```

ğŸ“˜

* `findstr /V` â†’ æŒ‡å®šæ–‡å­—åˆ—ã‚’å«ã¾ãªã„è¡Œã‚’è¡¨ç¤ºï¼ˆã¤ã¾ã‚Š \Microsoft\Windows é…ä¸‹ã‚’é™¤å¤–ï¼‰
* `/I` â†’ å¤§æ–‡å­—å°æ–‡å­—ç„¡è¦–

---

## âœ… 3ï¸âƒ£ ã€Œç¾åœ¨ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç™»éŒ²ã—ãŸã‚¿ã‚¹ã‚¯ã€ã ã‘è¡¨ç¤º

```cmd
cmd /c "for /f \"tokens=*\" %u in ('echo %USERNAME%') do schtasks /query /fo TABLE /v | findstr /I /C:\"%u\""
```

ğŸ§ 

* `echo %USERNAME%` ã§ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å–å¾—
* ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å«ã‚€ã‚¿ã‚¹ã‚¯ã‚’ `findstr` ã§æŠ½å‡º

---

## âœ… 4ï¸âƒ£ ã‚ˆã‚Šæ­£ç¢ºãªæ–¹æ³•ï¼ˆPowerShellçµŒç”±ï¼‰

CMD 1è¡Œã‹ã‚‰ PowerShell ã‚’å©ã„ã¦ã€
ã€ŒMicrosofté…ä¸‹ã‚’é™¤å¤–ã€ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚ã‚Šã€ã«çµã‚‹ä¾‹ğŸ‘‡

```cmd
cmd /c "powershell -NoProfile -Command \"Get-ScheduledTask | Where-Object { $_.TaskPath -notlike '\\Microsoft*' -and $_.Principal.UserId -ne $null } | Select-Object TaskName,TaskPath,State,@{Name='User';Expression={$_.Principal.UserId}} | Format-Table -AutoSize\""
```

ğŸ’¡

* CMDä¸Šã§å®Œçµã—ã¦å‘¼ã¹ã¾ã™
* PowerShell å†…éƒ¨ã§ `Where-Object` ã‚’ä½¿ã„ç´°ã‹ãçµã‚Šè¾¼ã¿
* å‡ºåŠ›ã¯æ•´ã£ãŸè¡¨å½¢å¼

---

## âœ… 5ï¸âƒ£ çµæœã‚’CSVã«å‡ºã—ãŸã„å ´åˆ

```cmd
cmd /c "powershell -NoProfile -Command \"Get-ScheduledTask | Where-Object { $_.TaskPath -notlike '\\Microsoft*' } | Select TaskName,TaskPath,State,@{Name='User';Expression={$_.Principal.UserId}} | Export-Csv 'C:\Temp\Tasks.csv' -NoTypeInformation -Encoding UTF8\""
```

â†’ `C:\Temp\Tasks.csv` ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

---

## âœ… 6ï¸âƒ£ C# ã® `ProcessStartInfo` ã§å‘¼ã¶å ´åˆï¼ˆä¾‹ï¼‰

```csharp
var psi = new ProcessStartInfo
{
    FileName = Environment.GetEnvironmentVariable("ComSpec"),
    Arguments = "/c powershell -NoProfile -Command \"Get-ScheduledTask | Where-Object { $_.TaskPath -notlike '\\Microsoft*' -and $_.Principal.UserId -ne $null } | Select TaskName,TaskPath,State,@{Name='User';Expression={$_.Principal.UserId}} | Format-Table -AutoSize\"",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    CreateNoWindow = true
};
```

---

âš™ï¸ ã¾ã¨ã‚

| ç›®çš„      | ã‚³ãƒãƒ³ãƒ‰                                    |                               |
| ------- | --------------------------------------- | ----------------------------- |
| ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ | `schtasks /query /fo TABLE /v`          |                               |
| ã‚·ã‚¹ãƒ†ãƒ é™¤å¤–  | `schtasks /query /fo TABLE /v           | findstr /V Microsoft\Windows` |
| ç¾ãƒ¦ãƒ¼ã‚¶ãƒ¼ã ã‘ | `schtasks /query /fo TABLE /v           | findstr /I "%USERNAME%"`      |
| æ­£ç¢ºãªçµã‚Šè¾¼ã¿ | `powershell -Command "Get-ScheduledTask | Where-Object {...}"`          |
| CSVå‡ºåŠ›   | `powershell -Command "Get-ScheduledTask | Export-Csv ..."`              |

---

ã©ã®å½¢å¼ã§å‡ºåŠ›ã—ãŸã„ã§ã™ã‹ï¼Ÿ
ãŸã¨ãˆã° ã€ŒC# ã‹ã‚‰å‘¼ã‚“ã§çµæœã‚’ãƒ‘ãƒ¼ã‚¹ã—ãŸã„ã€ ã‚„ ã€ŒCSVã«ä¿å­˜ã—ãŸã„ã€ ãªã©ç›®çš„ã«åˆã‚ã›ã¦æœ€é©åŒ–ã§ãã¾ã™ã€‚

ã‚ã£ã¡ã‚ƒè‰¯ã„æµã‚Œã§ã™ğŸ‘
ã¤ã¾ã‚Šä»Šåº¦ã¯ã€Œ**cmd /c ã‹ã‚‰ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ãŸã„**ã€ã§ã™ã­ã€‚
ã§ãã¾ã™ï¼ â€” `schtasks /delete` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã„ã¾ã™ã€‚

---

## âœ… åŸºæœ¬æ§‹æ–‡ï¼ˆcmd ç‰ˆï¼‰

```cmd
cmd /c "schtasks /delete /tn \"ã‚¿ã‚¹ã‚¯å\" /f"
```

### ğŸ§  èª¬æ˜

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³     | æ„å‘³               |
| --------- | ---------------- |
| `/delete` | ã‚¿ã‚¹ã‚¯å‰Šé™¤            |
| `/tn`     | ã‚¿ã‚¹ã‚¯ã®åå‰ï¼ˆTaskNameï¼‰ |
| `/f`      | ç¢ºèªãªã—ï¼ˆForceï¼‰      |

---

### ğŸ”¹ ä¾‹ï¼š

ã€ŒMyTaskã€ã¨ã„ã†ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹å ´åˆ

```cmd
cmd /c "schtasks /delete /tn \"MyTask\" /f"
```

---

### ğŸ”¹ ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã®ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ãŸã„å ´åˆ

ï¼ˆä¾‹ï¼š`\MyApp\AutoBackup`ï¼‰

```cmd
cmd /c "schtasks /delete /tn \"\MyApp\AutoBackup\" /f"
```

> ğŸ’¡ ãƒ‘ã‚¹æŒ‡å®šã®å…ˆé ­ã« `\` ãŒå¿…è¦ã§ã™ï¼ˆãƒ«ãƒ¼ãƒˆåŸºæº–ã§ï¼‰
> ä¾‹ï¼š `\Microsoft\Windows\Defrag` ã®ã‚ˆã†ã«ã€‚

---

## âœ… PowerShell çµŒç”±ã§ã‚‚å‰Šé™¤ã§ãã‚‹ï¼ˆæŸ”è»Ÿç‰ˆï¼‰

```cmd
cmd /c "powershell -NoProfile -Command \"Unregister-ScheduledTask -TaskName 'MyTask' -Confirm:$false\""
```

ã¾ãŸã¯ãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹æŒ‡å®šãªã‚‰ï¼š

```cmd
cmd /c "powershell -NoProfile -Command \"Unregister-ScheduledTask -TaskPath '\\MyApp\\' -TaskName 'AutoBackup' -Confirm:$false\""
```

ğŸ’¡ `Unregister-ScheduledTask` ã¯ PowerShellç‰ˆã®å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚
`schtasks` ã‚ˆã‚Šã‚‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆçš„ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ã‚„ã‚¨ãƒ©ãƒ¼ã‚‚æ˜ç¢ºã«å–ã‚Œã¾ã™ã€‚

---

## âœ… C# ã‹ã‚‰ `ProcessStartInfo` ã§å‘¼ã¶å ´åˆ

```csharp
var psi = new ProcessStartInfo
{
    FileName = Environment.GetEnvironmentVariable("ComSpec"),
    Arguments = "/c schtasks /delete /tn \"MyTask\" /f",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    RedirectStandardError = true,
    CreateNoWindow = true
};

using var p = Process.Start(psi);
string stdout = p.StandardOutput.ReadToEnd();
string stderr = p.StandardError.ReadToEnd();
p.WaitForExit();

Console.WriteLine("STDOUT: " + stdout);
Console.WriteLine("STDERR: " + stderr);
```

---

## âœ… ç¢ºèªä»˜ãã«ã—ãŸã„å ´åˆï¼ˆå®‰å…¨å‰Šé™¤ï¼‰

ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å‡ºã™ã«ã¯ `/f` ã‚’å¤–ã™ã ã‘ã§ã™ï¼š

```cmd
cmd /c "schtasks /delete /tn \"MyTask\""
```

ã™ã‚‹ã¨

```
è­¦å‘Š: ã‚¿ã‚¹ã‚¯ "MyTask" ã‚’å‰Šé™¤ã—ã¾ã™ã‹ (Y/N)?
```

ã¨èã‹ã‚Œã¾ã™ã€‚

---

## âœ… ã¾ã¨ã‚

| æ“ä½œ          | ã‚³ãƒãƒ³ãƒ‰ä¾‹                                                         | å‚™è€ƒ     |
| ----------- | ------------------------------------------------------------- | ------ |
| ã‚¿ã‚¹ã‚¯å‰Šé™¤ï¼ˆå¼·åˆ¶ï¼‰   | `schtasks /delete /tn "MyTask" /f`                            | æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ« |
| ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®š    | `schtasks /delete /tn "\MyApp\Backup" /f`                     | ãƒ‘ã‚¹å¿…é ˆ   |
| PowerShellç‰ˆ | `Unregister-ScheduledTask -TaskName 'MyTask' -Confirm:$false` | æŸ”è»Ÿ     |
| ç¢ºèªä»˜ã        | `/f` ã‚’å¤–ã™                                                      | å®‰å…¨æ“ä½œå‘ã‘ |

---

ğŸ’¬
ã‚‚ã—ã€Œä¸€è¦§ã§å‡ºã—ãŸã‚¿ã‚¹ã‚¯ã‚’é †ã«å‰Šé™¤ã—ãŸã„ã€ã‚„ã€Œç‰¹å®šæ¡ä»¶ï¼ˆä¾‹ï¼šUserIdãŒè‡ªåˆ†ï¼‰ã€ã®ã‚¿ã‚¹ã‚¯ã ã‘æ¶ˆã—ãŸã„ãªã‚‰ã€
PowerShellã‚’ `cmd /c` çµŒç”±ã§çµ„ã¿åˆã‚ã›ã¦ä¸€æ‹¬å‰Šé™¤ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

å¸Œæœ›ã—ã¾ã™ï¼Ÿï¼ˆä¾‹ï¼šã€Œè‡ªåˆ†ã®ä½œã£ãŸã‚¿ã‚¹ã‚¯ã ã‘å…¨éƒ¨å‰Šé™¤ã€ï¼‰

å®Œç’§ã§ã™ ğŸ’ª
ã€Œ**ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç™»éŒ²ã—ãŸã‚¿ã‚¹ã‚¯ã ã‘å‰Šé™¤**ã€ã—ãŸã„ â€” ã¤ã¾ã‚Šã€
Windowsæ¨™æº–ã‚¿ã‚¹ã‚¯ï¼ˆMicrosofté…ä¸‹ãªã©ï¼‰ã¯æ®‹ã—ã¦ã€**è‡ªåˆ†ãŒä½œã£ãŸã‚¿ã‚¹ã‚¯ã ã‘å…¨éƒ¨æ¶ˆã™**ã§ã™ã­ã€‚

ã“ã‚Œã€PowerShellã‚’ `cmd /c` çµŒç”±ã§å®Ÿè¡Œã™ã‚Œã° **1è¡Œã§å®‰å…¨ã«å®Ÿç¾ã§ãã¾ã™ã€‚**

---

## âœ… 1ï¸âƒ£ ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¹ã‚¯ã ã‘å‰Šé™¤ï¼ˆç¢ºèªãªã—ï¼‰

```cmd
cmd /c "powershell -NoProfile -Command \"$me=$env:USERNAME; Get-ScheduledTask | Where-Object { $_.Principal.UserId -match $me -and $_.TaskPath -notlike '\\Microsoft*' } | ForEach-Object { Unregister-ScheduledTask -TaskName $_.TaskName -TaskPath $_.TaskPath -Confirm:$false }\""
```

---

### ğŸ’¡ã“ã®ã‚³ãƒãƒ³ãƒ‰ãŒã‚„ã£ã¦ã„ã‚‹ã“ã¨

| å‡¦ç†å†…å®¹                                              | èª¬æ˜                |
| ------------------------------------------------- | ----------------- |
| `$me=$env:USERNAME`                               | ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å–å¾—  |
| `Get-ScheduledTask`                               | å…¨ã‚¿ã‚¹ã‚¯ã‚’å–å¾—           |
| `Where-Object { $_.Principal.UserId -match $me }` | ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«ä¸€è‡´ã™ã‚‹ã‚¿ã‚¹ã‚¯ã ã‘æ®‹ã™ |
| `-and $_.TaskPath -notlike '\Microsoft*'`         | Microsoftæ¨™æº–ã‚¿ã‚¹ã‚¯ã¯é™¤å¤– |
| `Unregister-ScheduledTask -Confirm:$false`        | ç¢ºèªãªã—ã§å‰Šé™¤           |

---

### ğŸ§© å‡ºåŠ›ä¾‹ï¼ˆå‚è€ƒï¼‰

å‰Šé™¤å¯¾è±¡ãŒã‚ã‚‹ã¨ï¼š

```
Unregister-ScheduledTask : ã‚¿ã‚¹ã‚¯ 'MyBackup' ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚
Unregister-ScheduledTask : ã‚¿ã‚¹ã‚¯ 'DailyReport' ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚
```

å‰Šé™¤å¯¾è±¡ãŒãªã‘ã‚Œã°ä½•ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

---

## âœ… 2ï¸âƒ£ ã€Œå¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŒ‡å®šã—ã¦å‰Šé™¤ã€ã—ãŸã„å ´åˆï¼ˆä¾‹: Administratorï¼‰

```cmd
cmd /c "powershell -NoProfile -Command \"$target='Administrator'; Get-ScheduledTask | Where-Object { $_.Principal.UserId -match $target -and $_.TaskPath -notlike '\\Microsoft*' } | ForEach-Object { Unregister-ScheduledTask -TaskName $_.TaskName -TaskPath $_.TaskPath -Confirm:$false }\""
```

---

## âœ… 3ï¸âƒ£ ç¢ºèªã‚ã‚Šã§å®‰å…¨ã«å‰Šé™¤ã—ãŸã„å ´åˆ

```cmd
cmd /c "powershell -NoProfile -Command \"$me=$env:USERNAME; Get-ScheduledTask | Where-Object { $_.Principal.UserId -match $me -and $_.TaskPath -notlike '\\Microsoft*' } | ForEach-Object { Unregister-ScheduledTask -TaskName $_.TaskName -TaskPath $_.TaskPath }\""
```

ğŸŸ¡ â†’ ã“ã®å ´åˆã€å‰Šé™¤ã”ã¨ã«

```
ç¢ºèª: ã‚¿ã‚¹ã‚¯ 'MyBackup' ã‚’å‰Šé™¤ã—ã¾ã™ã‹? [Y] ã¯ã„ [N] ã„ã„ãˆ
```

ã®ã‚ˆã†ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒå‡ºã¾ã™ã€‚

---

## âœ… 4ï¸âƒ£ C# `ProcessStartInfo` ã«çµ„ã¿è¾¼ã‚€ä¾‹

```csharp
var psi = new ProcessStartInfo
{
    FileName = Environment.GetEnvironmentVariable("ComSpec"),
    Arguments = "/c powershell -NoProfile -Command \"$me=$env:USERNAME; Get-ScheduledTask | Where-Object { $_.Principal.UserId -match $me -and $_.TaskPath -notlike '\\Microsoft*' } | ForEach-Object { Unregister-ScheduledTask -TaskName $_.TaskName -TaskPath $_.TaskPath -Confirm:$false }\"",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    RedirectStandardError = true,
    CreateNoWindow = true
};
```

---

## âœ… 5ï¸âƒ£ å‰Šé™¤å‰ã«ä¸€è¦§ã‚’å‡ºã—ã¦ç¢ºèªã—ãŸã„å ´åˆ

```cmd
cmd /c "powershell -NoProfile -Command \"$me=$env:USERNAME; Get-ScheduledTask | Where-Object { $_.Principal.UserId -match $me -and $_.TaskPath -notlike '\\Microsoft*' } | Select-Object TaskName,TaskPath,State\""
```

---

## âœ… ã¾ã¨ã‚

| ç›®çš„           | ã‚³ãƒãƒ³ãƒ‰                                                                          |
| ------------ | ----------------------------------------------------------------------------- |
| è‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤    | `/c powershell -Command "... $env:USERNAME ... Unregister-ScheduledTask ..."` |
| ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¹ã‚¯å‰Šé™¤ | `$target='UserName'` ã«ç½®æ›                                                      |
| ç¢ºèªã‚ã‚Š         | `-Confirm:$false` ã‚’å‰Šé™¤                                                         |
| å‰Šé™¤å‰ã«ä¸€è¦§ç¢ºèª     | `Select-Object TaskName,TaskPath`                                             |

---

ğŸ’¡ **ãŠã™ã™ã‚é‹ç”¨**
1ï¸âƒ£ ã¾ãšä¸€è¦§è¡¨ç¤ºã§ã€Œå¯¾è±¡ã€ç¢ºèª
2ï¸âƒ£ å•é¡Œãªã‘ã‚Œã° `/Confirm:$false` ä»˜ãã§å‰Šé™¤

---

å¿…è¦ãªã‚‰ã€Œç‰¹å®šãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ï¼ˆä¾‹ï¼š`\MyApp\`ï¼‰ã€ã ã‘æ¶ˆã™ç‰ˆã‚‚å‡ºã›ã¾ã™ã€‚å‡ºã—ã¾ã™ã‹ï¼Ÿ
